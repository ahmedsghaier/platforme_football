<div class="min-h-screen bg-gray-50">
  <!-- Header -->
  <header class="bg-white shadow-sm">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        <a [routerLink]="'/'" class="text-2xl font-bold text-blue-600 cursor-pointer" style="font-family: Pacifico, serif">
          FootballAI
        </a>
        <nav class="flex items-center space-x-6">
          <a [routerLink]="'/search'" class="text-blue-600 font-medium cursor-pointer">Recherche</a>
          <a [routerLink]="'/compare'" class="text-gray-600 hover:text-blue-600 transition-colors cursor-pointer">Comparateur</a>
          <a [routerLink]="'/dashboard'" class="text-gray-600 hover:text-blue-600 transition-colors cursor-pointer">Tableau de bord</a>
        </nav>
      </div>
    </div>
  </header>

  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Search Header -->
    <div class="bg-white rounded-xl shadow-sm p-6 mb-8">
      <h1 class="text-3xl font-bold text-gray-900 mb-6">Recherche avancée de joueurs</h1>
      
      <!-- Search Bar -->
      <div class="relative mb-6">
        <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
          <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
        </div>
        <input
          type="text"
          [(ngModel)]="searchQuery"
          (input)="onSearchChange($event)"
          placeholder="Rechercher par nom, club ou position..."
          class="w-full pl-12 pr-4 py-3 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
        />
      </div>

      <!-- Filters -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2" for="position-filter">Position</label>
          <div class="relative">
            <select 
              id="position-filter"
              [(ngModel)]="filters.position"
              (change)="onFilterChange('position', $event)"
              class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent pr-8 appearance-none"
              aria-label="Select player position"
            >
              <option value="">Toutes positions</option>
              <option *ngFor="let position of availablePositions" [value]="position">{{ position }}</option>
            </select>
            <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
              <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
              </svg>
            </div>
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2" for="club-filter">Club</label>
          <div class="relative">
            <select 
              id="club-filter"
              [(ngModel)]="filters.club"
              (change)="onFilterChange('club', $event)"
              class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent pr-8 appearance-none"
              aria-label="Select club"
            >
              <option value="">Tous clubs</option>
              <option *ngFor="let club of availableClubs" [value]="club">{{ club }}</option>
            </select>
            <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
              <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
              </svg>
            </div>
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2" for="league-filter">Championnat</label>
          <div class="relative">
            <select 
              id="league-filter"
              [(ngModel)]="filters.league"
              (change)="onFilterChange('league', $event)"
              class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent pr-8 appearance-none"
              aria-label="Select league"
            >
              <option value="">Tous championnats</option>
              <option *ngFor="let league of availableLeagues" [value]="league">{{ league }}</option>
            </select>
            <div class="absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none">
              <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
              </svg>
            </div>
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2" for="age-filter">Âge</label>
          <div class="flex gap-2">
            <input
              id="age-min-filter"
              type="number"
              [(ngModel)]="filters.ageMin"
              (input)="onFilterChange('ageMin', $event)"
              placeholder="Min"
              class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              min="0"
              aria-label="Minimum age"
            />
            <input
              id="age-max-filter"
              type="number"
              [(ngModel)]="filters.ageMax"
              (input)="onFilterChange('ageMax', $event)"
              placeholder="Max"
              class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              min="0"
              aria-label="Maximum age"
            />
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2" for="value-filter">Valeur (M€)</label>
          <div class="flex gap-2">
            <input
              id="value-min-filter"
              type="number"
              [(ngModel)]="filters.valueMin"
              (input)="onFilterChange('valueMin', $event)"
              placeholder="Min"
              class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              min="0"
              aria-label="Minimum value"
            />
            <input
              id="value-max-filter"
              type="number"
              [(ngModel)]="filters.valueMax"
              (input)="onFilterChange('valueMax', $event)"
              placeholder="Max"
              class="w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
              min="0"
              aria-label="Maximum value"
            />
          </div>
        </div>
      </div>

      <!-- Reset Filters Button -->
      <div class="mb-6">
        <button
          (click)="resetFilters()"
          class="px-4 py-2 text-sm text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"
        >
          Réinitialiser les filtres
        </button>
      </div>

      <!-- View Mode Toggle -->
      <div class="flex items-center justify-between mb-6">
        <p class="text-gray-600">{{ filteredPlayers.length }} joueur{{ filteredPlayers.length > 1 ? 's' : '' }} trouvé{{ filteredPlayers.length > 1 ? 's' : '' }}</p>
        <div class="flex items-center gap-2">
          <button
            (click)="setViewMode('grid')"
            [class]="'p-2 rounded-lg cursor-pointer transition-colors ' + (viewMode === 'grid' ? 'bg-blue-100 text-blue-600' : 'text-gray-400 hover:text-gray-600')"
            title="Affichage en grille"
            aria-label="Switch to grid view"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path>
            </svg>
          </button>
          <button
            (click)="setViewMode('list')"
            [class]="'p-2 rounded-lg cursor-pointer transition-colors ' + (viewMode === 'list' ? 'bg-blue-100 text-blue-600' : 'text-gray-400 hover:text-gray-600')"
            title="Affichage en liste"
            aria-label="Switch to list view"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"></path>
            </svg>
          </button>
        </div>
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="flex justify-center items-center py-12">
      <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"></div>
    </div>

    <!-- Error State -->
    <div *ngIf="error" class="bg-red-50 border border-red-200 rounded-lg p-4 mb-6">
      <div class="flex">
        <svg class="w-5 h-5 text-red-400 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <p class="text-red-800">{{ error }}</p>
      </div>
      <button 
        (click)="refreshData()"
        class="mt-2 px-4 py-2 text-sm text-red-800 hover:text-red-900 underline"
      >
        Réessayer
      </button>
    </div>

    <!-- Grid View -->
    <div *ngIf="viewMode === 'grid' && !isLoading && !error" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
      <div 
        *ngFor="let player of filteredPlayers; trackBy: trackByPlayerId"
        (click)="navigateToPlayer(player.id)"
        class="bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-md transition-shadow cursor-pointer"
      >
        <img 
          [src]="player.image" 
          [alt]="player.name"
          class="w-full h-4à object-cover object-top"
          loading="lazy"
        />
        <div class="p-6">
          <h3 class="font-bold text-lg text-gray-900 mb-1">{{ player.name }}</h3>
          <p class="text-gray-600 text-sm mb-2">{{ player.clubName }} • {{ player.position }}</p>
          <div class="flex items-center gap-4 text-sm text-gray-500 mb-3">
            <span>{{ player.age }} ans</span>
            <span>{{ player.nationality }}</span>
          </div>
          <div class="flex justify-between items-center">
            <span class="text-xl font-bold text-green-600">{{ convertToMillions(player.marketValueNumeric) }}</span>
            <span class="text-xs text-gray-500">IA: {{ getConfidencePercentage(player.confidence) }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- List View -->
    <div *ngIf="viewMode === 'list' && !isLoading && !error" class="bg-white rounded-xl shadow-sm overflow-hidden">
      <div class="overflow-x-auto">
        <table class="w-full">
          <thead class="bg-gray-50">
            <tr>
              <th class="text-left py-3 px-6 font-medium text-gray-500 text-sm">Joueur</th>
              <th class="text-left py-3 px-6 font-medium text-gray-500 text-sm">Club</th>
              <th class="text-left py-3 px-6 font-medium text-gray-500 text-sm">Position</th>
              <th class="text-left py-3 px-6 font-medium text-gray-500 text-sm">Âge</th>
              <th class="text-left py-3 px-6 font-medium text-gray-500 text-sm">Valeur</th>
              <th class="text-left py-3 px-6 font-medium text-gray-500 text-sm">Confiance IA</th>
            </tr>
          </thead>
          <tbody>
            <tr 
              *ngFor="let player of filteredPlayers; trackBy: trackByPlayerId"
              class="border-t hover:bg-gray-50 cursor-pointer transition-colors"
              (click)="navigateToPlayer(player.id)"
            >
              <td class="py-4 px-6">
                <div class="flex items-center gap-3">
                  <img 
                    [src]="player.image" 
                    [alt]="player.name"
                    class="w-10 h-10 object-cover object-top rounded-full"
                    loading="lazy"
                  />
                  <div>
                    <div class="font-medium text-gray-900">{{ player.name }}</div>
                    <div class="text-sm text-gray-500">{{ player.nationality }}</div>
                  </div>
                </div>
              </td>
              <td class="py-4 px-6 text-gray-900">{{ player.clubName }}</td>
              <td class="py-4 px-6 text-gray-600">{{ player.position }}</td>
              <td class="py-4 px-6 text-gray-600">{{ player.age }} ans</td>
              <td class="py-4 px-6 font-semibold text-green-600">{{ convertToMillions(player.marketValueNumeric) }}</td>
              <td class="py-4 px-6 text-gray-500">{{ player.confidence }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="!isLoading && !error && filteredPlayers.length === 0" class="text-center py-12">
      <svg class="w-16 h-16 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
      </svg>
      <h3 class="text-lg font-medium text-gray-900 mb-2">Aucun joueur trouvé</h3>
      <p class="text-gray-500 mb-4">Essayez de modifier vos critères de recherche</p>
      <button 
        (click)="resetFilters()"
        class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
      >
        Réinitialiser les filtres
      </button>
    </div>
  </div>
</div>